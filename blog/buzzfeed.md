---
title: "Buzzfeed Takehome"
date: "2019-08-30"
hero-image: "buzzfeed.jpg"
---

# Analysis 

## AdType A and AdType B are the only revenue sources - calculate the total revenue in Q1

Knowing that CPM is the amount paid to Buzzfeed for every thousand ad impressions, we can take the number of impressions from Ad Type A and B divided by 1000 and multiply that amount by the CPM. 

![](https://paper-attachments.dropbox.com/s_1AB3FBC84EC352AA3E04275F4278394E5173CE5136EB4DC11E84B8ADDAFA6A9B_1571803773975_image.png)

Total Revenue over Q1 across both ad types is <b>$6924.99</b>, $1374.48 from type A ads and $5,550.51 from type B ads. 


## Visualize the trends in daily pageviews, total daily revenue and total daily impressions over Q1. How would you describe what you’re seeing to a stakeholder?  Use any calculations that might help you summarize the data. 

### Visualizations 

The red lines represent the change day to day, while the blue lines represent the average per month and the black dotted lines presents the trend over each month.

### Pageviews
<div class='tableauPlaceholder' id='viz1571799068215' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Pageviews&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='BuzzfeedTakehome&#47;Pageviews' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Pageviews&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1571799068215');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

### Impressions
<div class='tableauPlaceholder' id='viz1571799096905' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Impressions&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='BuzzfeedTakehome&#47;Impressions' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Impressions&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1571799096905');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

### Revenue
<div class='tableauPlaceholder' id='viz1571799153159' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Revenue&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='BuzzfeedTakehome&#47;Revenue' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Bu&#47;BuzzfeedTakehome&#47;Revenue&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1571799153159');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1024px';vizElement.style.height='795px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>

### Summary 

Ad Type A Revenue and Impressions decreased 21% January to February and 59% February to March. Ad Type B Revenue and Impressions increased 37% January to February and 65% February to March. The trend month to month also occurred during February while maining fairly consistent through the other months. 

#### Page views 

When looking that pageviews chart, we can see that views have remained pretty consistent with average views ranging from 9,020 to 8,809 views which translates into a decrease in views of 1% month to month.

#### Revenue and Impressions 

When looking at total impressions and revenue, the total percent change month over month reflects the same changes found in page views which was a 1% decrease month over month. Similarly, we see the same drop offs in Ad Type A impressions as in Ad Type A Revenue as well as the same increases in Ad Type B month over month in both impressions and revenue.

## Your work highlights that revenue has been changing. Why has this happened?  Dig into the two types of ads, and how their impressions may have changed over time, and present your findings in a way that a non-technical stakeholder could easily understand.

The key driver for these changes are the number of impressions for both ad types. Though total impressions have only changed 1% month to month, the change in revenue is due to larger changes in impressions in the individual ad types. Ad Type A Revenue and Impressions decreased 21% January to February and 59% February to March. Ad Type B Revenue and Impressions increased 37% January to February and 65% February to March. Total revenue has continued to increase month over month due to the fact that Ad Type B revenue has increased over the quarter and the CPM for Ad Type B is also much greater than Ad Type A. 

As mentioned earlier, the biggest changes in both Ad Type A and Ad Type B occurred during the month of February meaning something must have happened during that month. In addition, when looking closely at the trends in March, both ad types are gradually decreasing.

## After completing this work, you are tasked with developing strategies for increasing daily revenue.  Throw out any ideas for follow-up questions you’d like to ask or lines of investigation you already have in mind - there are no wrong answers!

### Strategy: Focus on what is working

Based on the data, Ad Type B is working better than Ad Type A. However, both have decreased in March. Looking at successes from this quarter and previous years, we can determine why they were successful and replicate that success. In addition, becuase Ad Type A has decreased in March, we can also use this opportunity to make and test changes. Lower revenue can make it a good time to make changes with lower risk. Try new placements or new demand. Roll out some new content that might reverse the traffic patterns, run ad-serving and content experiments. We can also measure how the two different ad types are affecting one another. 

Before that can take place, we need to answer a few questions. 

- What types of pages are these ads located? Articles, quizzes, listicles, shopping? 
    - This will help us determine whether certain pages perform better than others.  
- Outside of what pages they are located, what pages are getting the highest hits? 
    - We want to find what pages are successful and therefore want to know what works about these pages.
- What type of ads are getting the most impressions? 
    - Right now they are Ad Type B but perviously they were Ad Type A
- Were there any changes made to Ad Type A or B during February? Any changes to the size of the ads? Any changes to the targeting? Did we start adding too many ads to the pages? 
    - The greatest changes occurred during February as such something must have changed during that month. 
- Where are these ads being placed? 
    - Pinpointing where the ads are being placed can help determine whether users are seeing the ads and if they are appropriately placed. 
- Is the ad density on the site too high? 
    - Too many ads could deter users from engaging with the site and the ads. 
- Are they successful because they are more engaging?  
    - This will help identify what ads are successful.
- Are the some ads better at targeting the audience than others? 
    - Ad Type A could be underperforming because they are weaker at targeting the users. 
- Who is the audience we are trying to target? 
    - If we can understand our users better, we can curate better ads and increase 
- How is the audience engaging with our content and ads? Which ads are most engaging? What content are they reading?
    - This will help us understand what type of content and ads are most successful.
- Which ads have the highest conversion rate? 
    - This will help us understand what will get us more revenue. 
- What devices are our users using to access our content? (tablets, phones, website, iOS application, web browser)
    - This will help us understand if there are certain ads that are optimized for specific devices.

Other lines of investigation would be:

- Look into changes in both ad types 
- Look into changes such as the design and loading times to the various platforms 
    - web page, phone application
- Monitor for the next quarter to see if the drop lasts, it may be indicating that there are other causes affecting the CPM

# SQL Analysis 

All answers are answered in PostgreSQL.

## A colleague tells you there is only record per source per date in `revenue_table_1`, and only record per date in `revenue_table_2`.  Write the queries to check if your colleague is correct.

Revenue Table 1 Query 

```sql
SELECT distinct(date), revenue_source, 
    count(revenue_source) as number_of_records 
FROM revenue_table_1
GROUP BY 1, 2
```

Revenue Table 2 Query

```sql
SELECT distinct(timestamp), count(revenue) AS number_of_records
FROM revenue_table_2
GROUP BY 1
```

## Spoiler alert: your colleague was correct! Now write the sql to create the combined `final_table` table as shown above. Make sure that you account for the date offset between the two tables.

```sql
CREATE TABLE final_table AS
    SELECT a.date::DATE, 
        sum(CASE WHEN a.revenue_source = 'source_a' THEN a.revenue END) AS source_a,
        sum(CASE WHEN a.revenue_source = 'source_b' THEN a.revenue END) AS source_b,
        sum(CASE WHEN a.revenue_source = 'source_c' THEN a.revenue END) AS source_c, 
        b.revenue AS source_d
    FROM revenue_table_1 a 
    LEFT JOIN revenue_table_2 b
    ON a.date = (b.date::DATE - '1 day'::interval)
    GROUP BY 1, b.revenue
    ORDER BY 1
```


## Based on this `final_table`, write the sql to compute the total revenue earned so far (across all 4 sources combined) in 2019 (assume the tables do contain revenue data prior to 2019)

```sql
SELECT extract('year' FROM date) AS YEAR, 
    SUM(source_a + source_b + source_c + source_d) AS total_revenue
FROM final_table
WHERE DATE >= '2019-01-01'::DATE
AND DATE < ('2019-01-01'::DATE + '1 year'::interval)
GROUP BY 1
```